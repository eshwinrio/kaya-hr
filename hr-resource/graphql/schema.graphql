scalar ISODate
scalar Decimal

enum Role {
  SUPER
  ADMIN
  MANAGER
  LEAD
  EMPLOYEE
}

enum SyncStatus {
  NEVER
  OK
  FAIL
}

type ClockTime {
  id: Int!
  startTime: ISODate!
  endTime: ISODate!
  timesheetId: Int!
}

type Timesheet {
  id: Int!
  userId: Int!
  hourlyWage: Decimal!
}

type Schedule {
  id: Int!
  title: String!
  dateTimeStart: ISODate!
  dateTimeEnd: ISODate!
  employees: [User!]
  createdBy: User
  createdAt: ISODate!
  positions: [Position!]
}

type Position {
  id: Int!
  title: String!
  description: String
  hourlyWage: Decimal
  users: [User!]
  schedules: [User!]
}

type User {
  id: Int!
  firstName: String!
  middleName: String
  lastName: String!
  dateOfBirth: ISODate!
  email: String!
  streetName: String!
  addressL2: String
  city: String!
  pincode: String!
  province: String!
  phone: String!
  country: String!
  dateJoined: ISODate!
  status: String
  syncStatus: SyncStatus
  profileIconUrl: String
  bannerUrl: String
  organization: Organization
  timesheets: [Timesheet]
  schedules: [ScheduleAssignment!]
  roles: [Role!]
  positions: [Position!]
}

type ScheduleAssignment {
  id: Int!
  user: User!
  schedule: Schedule!
  position: Position!
}

type Organization {
  id: Int!
  name: String!
  summary: String
  webUrl: String
  bannerUrl: String
  logoUrl: String
  users: [User!]
}

type UserSyncResult {
  accepted: Int!
  rejected: Int!
}

# Input types
input CreateUserInput {
  firstName: String!
  middleName: String
  lastName: String!
  email: String!
  dateOfBirth: ISODate!
  streetName: String!
  addressL2: String
  city: String!
  pincode: String!
  province: String!
  phone: String!
  country: String!
  dateJoined: ISODate!
  status: String
  organizationId: Int
  profileIconUrl: String
  bannerUrl: String
  password: String!
  roles: [Role!]
  positionIds: [Int!]
}

input CreateOrganizationInput {
  name: String!
  summary: String
  webUrl: String!
  bannerUrl: String!
  logoUrl: String!
}

input UpdateOrganizationInput {
  name: String
  summary: String
  webUrl: String
  bannerUrl: String
  logoUrl: String
}

input PositionInput {
  title: String!
  description: String
  hourlyWage: Decimal
}

input ScheduleAssigneeInput {
  userId: Int!
  positionId: Int!
}

input ScheduleInput {
  title: String
  dateTimeStart: ISODate!
  dateTimeEnd: ISODate!
  assignees: [ScheduleAssigneeInput!]
  notes: String
}

input ListScheduleFilterInput {
  userId: Int
  createdByUserId: Int
  title: String
  from: ISODate
  to: ISODate
}

input ViewUserOptions {
  searchTerm: String
}

# Root types
type Query {
  # Users
  currentUser: User!
  user(id: Int!): User!
  users(options: ViewUserOptions): [User]!

  # Shift scheduling
  scheduledShifts(filters: ListScheduleFilterInput): [ScheduleAssignment!]!
}

type Mutation {
  # Users
  createPosition(input: PositionInput!): Int!
  createOrganization(input: CreateOrganizationInput!): Int!
  createUser(input: CreateUserInput!): Int!
  updateOrganization(id: Int!, input: UpdateOrganizationInput!): Int!
  syncUsers(force: Boolean): UserSyncResult!

  # Shift scheduling
  createSchedule(input: ScheduleInput!): Schedule!
  updateSchedule(scheduleId: Int!, input: ScheduleInput!): Schedule!
  deleteSchedule(scheduleId: Int!): Schedule!
}
